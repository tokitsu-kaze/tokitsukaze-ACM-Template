# [AGC002F] Leftmost Ball

## 题面

给你 $n$ 种颜色的球，每种颜色的球有 $k$ 个，把这 $n\times k$ 个球排成一排，把每一种颜色的最左边出现的球涂成白色(初始球不包含白色)，求有多少种不同的颜色序列，答案对 $10^9+7$ 取模。

$1\leq n, k\leq 2000$。

https://atcoder.jp/contests/agc002/tasks/agc002_f

## 想法

- 2024.07.28
- 考虑颜色第一次出现的位置，后面随便填

## 题解

- 任意前缀，白球个数一定大于等于其他颜色的球的种类数
- 考虑 $dp_{i,j}$ 表示放了 $i$ 个白球 $j$ 种其他颜色的第一个球的方案数，$i \geq j$
- 转移考虑当前序列中从左到右**第一个空位**放白球还是放其他颜色球
- 放白球，必定合法，直接从 $dp_{i-1,j}$ 转移
- 放其他颜色球，从 $dp_{i,j-1}$ 转移，先从剩下的 $n-j+1$ 种选一种颜色，由于放第一个空位，并且 $i \geq j$，所以必定合法；放完后，在剩下的 $n \times k-i-(j-1)\times(k-1)-1$ 个空位中放 $k-2$ 个球
- $dp_{i,j}=dp_{i-1,j}+dp_{i,j-1} \times (n-j+1) \times \binom{n \times k-i-(j-1)\times(k-1)-1}{k-2}$ 
- 初始化 $dp_{i,0}=1$ ，答案 $dp_{n,n}$
- $k=1$ 要特判

## 总结

本题难点在于状态的表示，想到状态之后好像也不算很难。